<!DOCTYPE html><html lang=en-gb-x-sneddy><head><meta charset=utf-8>
<title>spec-gen 1.0b1-dev</title>
<link href=http://www.whatwg.org/style/specification rel=stylesheet> <style>
a:not([href]) {
background-color: #00f;
color: #fff;
}
span:not([title=""]):not(.secno) {
background-color: #a00;
color: #fff;
}
</style>

</head><body><div class=head>
	<h1>spec-gen 1.0b1-dev</h1>
	<h2 class="no-num no-toc" id=documentation-—-[date]>Documentation — 31 July 2008</h2>
</div>

<h2 class="no-num no-toc" id=contents>Contents</h2>

<!--begin-toc-->
<ol class=toc>
	<li><a href=#introduction><span class=secno>1 </span>Introduction</a></li>
	<li><a href=#installing-the-spec-gen><span class=secno>2 </span>Installing the spec-gen</a>
		<ol>
			<li><a href=#requirements><span class=secno>2.1 </span>Requirements</a></li>
			<li><a href=#obtaining-a-copy><span class=secno>2.2 </span>Obtaining a copy</a></li>
			<li><a href=#installation><span class=secno>2.3 </span>Installation</a></li>
			<li><a href=#running-the-test-suite><span class=secno>2.4 </span>Running the test suite</a></li></ol></li>
	<li><a href=#using-the-spec-gen><span class=secno>3 </span>Using the spec-gen</a></li>
	<li><a href=#processes><span class=secno>4 </span>Processes</a>
		<ol>
			<li><a href=#cross-referencing-0><span class=secno>4.1 </span>Cross-referencing</a></li>
			<li><a href=#table-of-contents/section-numbering><span class=secno>4.2 </span>Table of contents/section numbering</a></li></ol></li></ol>
<!--end-toc--><h2 id=introduction><span class=secno>1 </span>Introduction</h2>

<p>The need for the spec-gen came from the need for long technical documents to
include niceties such as cross-references and a table of contents for the
purpose of easy navigation — doing this manually can be a great chore
especially when sections are numbered and a section is added, consequently
changing the numbering of many others, leading to it being advantageous to do it
programmatically.</p>

<h2 id=installing-the-spec-gen><span class=secno>2 </span>Installing the spec-gen</h2>

<h3 id=requirements><span class=secno>2.1 </span>Requirements</h3>

<p>The following are the minimum requirements: later versions should also work
without issue.</p>

<ul>
	<li><a>Python</a> 2.5
	</li><li><a>lxml</a> 2.0
	</li><li><a>html5lib</a> 0.10
</li></ul>

<h3 id=obtaining-a-copy><span class=secno>2.2 </span>Obtaining a copy</h3>

<p>Releases are occasionally made. A link to the latest release can be found
from the <a>spec-gen website</a>.</p>

<p>Alternatively, a copy can be obtained from <dfn id=our-mercurial-repository>our <a>Mercurial</a>
repository</dfn>: this is where our ongoing development occurs, and allows any
revision (and therefore any release) to be downloaded. Our repository is located
at
<code><a href=http://hg.gsnedders.com/spec-gen/>http://hg.gsnedders.com/spec-gen/</a></code>.

</p><h3 id=installation><span class=secno>2.3 </span>Installation</h3>

<p>Normally, installation is done through <a>setuptools</a>, with the following
command:</p>

<p><code>python setup.py install</code></p>

<p>Please see setuptools' documentation for information on installation options
(such as installing in non-standard locations).</p>

<h3 id=running-the-test-suite><span class=secno>2.4 </span>Running the test suite</h3>

<p>The source distribution and the current development copy (in <a href=#our-mercurial-repository title="our
mercurial repository">Mercurial</a>) both contain a test suite. It can be run
with the following command:</p>

<p><code>python runtests.py</code></p>

<p>Any test failures should be reported at our <dfn id=bug-tracker><a href=http://bugs.gsnedders.com/projects/show/spec-gen>bug
tracker</a></dfn>.</p>

<h2 id=using-the-spec-gen><span class=secno>3 </span>Using the spec-gen</h2>

<p>The spec-gen is invoked through the <code>spec-gen</code> command. The
<dfn id=help><code>--help</code></dfn> (or <dfn id=h><code>-h</code></dfn>) option gives some
basic help.</p>

<p>The most basic options alter what is used to parse and serialize the
document: by default, html5lib is used to parse the document; passing the
<dfn id=lxml.html><code>--lxml.html</code></dfn> option uses libxml2's HTML parser and
serializer instead (this is quicker, but does not comply to the <a>HTML 5</a>
standard, and sometimes results in a <a href=#fatal-error>fatal error</a>)<!--; passing the XXX: need double hyphen <dfn><code>xml</code></dfn> option uses libxml2's XML parser instead-->.</p>

<p>The spec-gen offers a <dfn id=compatibility-mode>compatibility mode</dfn>, which aims to be
compatible with the <a>CSS3 module postprocessor</a> (within reason). This is
mainly provided for the sake of pre-existing <a>W3C</a> documents. The
<dfn id=w3c-compat><code>--w3c-compat</code></dfn> option turns on this compatibility mode,
although specific options that turn on just one compatibility feature at a time
are also available (and are documented below under each <a href=#processes title=processes>process</a>) — these are all implied by the
<a href=#w3c-compat><code>--w3c-compat</code></a> options, with one exception:
<code>--w3c-compat-crazy-substitutions</code>, as it can lead to undesirable
results.</p>

<p>Other <a href=#processes title=processes>process</a> specific options are documented
under the <a href=#processes title=processes>process</a> to which they belong.</p>

<h2 id=processes><span class=secno>4 </span><dfn>Processes</dfn></h2>

<p>The elements listed in the below processes, except where otherwise stated,
are the local name of the element <!--either--> in null namespace<!-- or in the
<dfn>HTML namespace</dfn> (<code>http://www.w3.org/1999/xhtml</code>)-->.</p>

<p>Upon a <dfn id=fatal-error>fatal error</dfn> processing of the document is terminated and
nothing is written to the output file.</p>

<p>The <dfn id=textcontent>textContent</dfn> property is the same as that defined in <a>DOM
Level 3 Core</a> on the Node interface.</p>

<p><dfn id=whitespace>Whitespace</dfn> is as defined in <a>HTML 5</a>: <q>U+0020 SPACE, U+0009
CHARACTER TABULATION (tab), U+000A LINE FEED (LF), U+000C FORM FEED (FF), and
U+000D CARRIAGE RETURN (CR)</q>.</p>

<h3 id=cross-referencing-0><span class=secno>4.1 </span>Cross-referencing</h3>

<p><dfn id=cross-referencing>Cross-referencing</dfn> has two essential parts: <dfn id=term title=term>terms</dfn> that define what something is, and <dfn id=instance title=instance>instances</dfn> of those terms.</p>

<p><a href=#term title=term>Terms</a> are marked-up using the <code>dfn</code>
element: the <a href=#term>term</a> itself is taken from the <code>title</code>
attribute if it is present, otherwise it is taken from the
<a href=#textcontent>textContent</a> property of the <code>dfn</code> element. By default,
the spec-gen will throw a <a href=#fatal-error>fatal error</a> if a <a href=#term>term</a> is
defined more than once: this behaviour can be turned off (causing the final
definition of the <a href=#term>term</a> to be the one that is used) by the
<dfn id=allow-duplicate-terms><code>--allow-duplicate-terms</code></dfn> option.

</p><p><a href=#instance title=instance>Instances</a> are marked-up with various elements,
depending on the setting of <dfn id=w3c-compat-elements><code>--w3c-compat-elements</code></dfn>: if it
is disabled (the default), the <code>abbr</code>, <code>code</code>,
<code>i</code>, <code>span</code>, and <code>var</code> elements are used for
<a href=#instance title=instance>instances</a>; if it is enabled, the
<code>abbr</code>, <code>acronym</code>, <code>b</code>, <code>bdo</code>,
<code>big</code>, <code>code</code>, <code>del</code>, <code>em</code>,
<code>i</code>, <code>ins</code>, <code>kbd</code>, <code>label</code>,
<code>legend</code>, <code>q</code>, <code>samp</code>, <code>small</code>,
<code>span</code>, <code>strong</code>, <code>sub</code>, <code>sup</code>,
<code>tt</code>, <code>var</code> elements are used for <a href=#instance title=instance>instances</a>. Those that are only there in
<a href=#compatibility-mode>compatibility mode</a> are there because either they shouldn't
semantically be used for an <a href=#instance>instance</a>, or because they aren't
present in <a>HTML 5</a>. Similar to <a href=#term title=term>terms</a>, the <a href=#instance>instance</a> is taken from the
<code>title</code> attribute if it is present, otherwise it is taken from the
<a href=#textcontent>textContent</a> property. An <a href=#instance>instance</a> is only used if it
does not have an <code>a</code>, <code>dfn</code>, or <code>datagrid</code>
element as either a parent or a child.</p>

<p>Both <a href=#term title=term>terms</a> and <a href=#instance title=instance>instances</a> are <dfn id=cross-reference-normalization title="cross-reference
normalization">normalized</dfn> as follows:</p>

<ul>
	<li>Leading and trailing <a href=#whitespace>whitespace</a> is stripped,
	</li><li>Converted to lowercase (behaviour of this is dependent on the current
locale setting of Python),
	</li><li>All consecutive <a href=#whitespace>whitespace</a> is replaced with a single U+0020
SPACE CHARACTER<!-- unless there is a <code>pre</code> element as a parent-->,
and
	</li><li>If <dfn id=w3c-compat-xref-normalization><code>--w3c-compat-xref-normalization</code></dfn> is enabled, all
characters apart from U+0020 SPACE CHARACTER, U+002D HYPHEN-MINUS (-), U+0030
DIGIT ZERO to U+0039 DIGIT NINE (0–9), U+0041 LATIN CAPITAL LETTER A to U+005A
LATIN CAPITAL LETTER Z (A–Z), and U+0061 LATIN SMALL LETTER A to U+007A LATIN
SMALL LETTER Z (a–z) are removed.
</li></ul>

<p>If the <a href=#instance>instance</a> is contained within a <code>span</code> element,
the <code>span</code> element is turned into an <code>a</code> element, and a
<code>href</code> attribute is added to link it to the <a href=#term>term</a> (e.g.,
<code>&lt;span&gt;foo&lt;/span&gt;</code> becomes <code>&lt;a
href=#foo&gt;foo&lt;/a&gt;</code>) — all other attributes are preserved. Otherwise
(when the <a href=#instance>instance</a> is not contained within a <code>span</code>
element), the location of the <code>a</code> element when linking an
<a href=#instance>instance</a> is dependent on the
<dfn id=w3c-compat-xref-a-placement><code>--w3c-compat-xref-a-placement</code></dfn> option: if it is disabled
(the default), the <code>a</code> element is placed around the element
containing the <a href=#instance>instance</a> (e.g., <code>&lt;i&gt;foo&lt;/i&gt;</code>
becomes <code>&lt;a href=#foo&gt;&lt;i&gt;foo&lt;/i&gt;&lt;/a&gt;</code>); if it is enabled,
the <code>a</code> element goes within the element containing the
<a href=#instance>instance</a> and goes around all of its content (e.g.,
<code>&lt;i&gt;foo&lt;/i&gt;</code> becomes <code>&lt;i&gt;&lt;a
href=#foo&gt;foo&lt;/a&gt;&lt;/i&gt;</code>).</p>

<h3 id=table-of-contents/section-numbering><span class=secno>4.2 </span>Table of contents/section numbering</h3>

<p>To create a table of contents, and to number the <span title=section>sections</span> of the document, an <span>outline</span> is
created. This means not only are the <code>h1</code>–<code>h6</code> elements
supported, but also elements such as <code title="">section</code> are used to
create the <span>outline</span>. After creating the <span>outline</span>, every
<span>section</span> with a depth between those provided by
<dfn id=min-depth><code>--min-depth</code></dfn> and <dfn id=max-depth><code>--max-depth</code></dfn>
(defaulting to two and six respectively), and which has a <span title="section
heading">heading</span>, is numbered if it does not have <code>no-num</code> as
a class, and is added to the table of contents if it does not have
<code>no-toc</code> as a class. <span title=section>Sections</span> without a
<span title="section heading">heading</span> are treated as if they didn't
exist, unless they have children, in which they will appear to exist while not
existing all at once (e.g., they increment the <span>section</span> numbering,
though that is not output anywhere; and they get a list item in the table of
contents, with only the children within it, and no link to the
<span>section</span> itself).</p>

<p>The format of <span>section</span> numbers should comply with <a>ISO
2145:1978</a>, Numbering of divisions and subdivisions in written documents.
This means that each <span>section</span> number is given by Arabic numerals,
seperated by a single U+002E FULL STOP character, and there is no trailing
U+002E FULL STOP character.</p>

<p>The <span>section</span> number is inserted as the first child node of the
<span>section heading</span> as a <code>span</code> element with the
<code>class</code> attribute set to <code>secno</code>: this is copied into the
table of contents.</p>

<p>Pre-existing <code>span</code> elements with a class of <code>secno</code>
are removed from all <span title="section heading">section headings</span>,
regardless of whether their depth falls within the range given by
<a href=#min-depth><code>--min-depth</code></a> and <a href=#max-depth><code>--max-depth</code></a>.</p>

<p>The table of contents is built up as an ordered list (an <code>ol</code>
element), with each <span>section</span> marked up as a <code>li</code> element,
and child <span title=section>sections</span> are marked up with an
<code>ol</code> within that <code>li</code> (and this continues recursively, ad
infinitum). By default, the root element of the table of contents (an
<code>ol</code> element) is given a <code>class</code> attribute set to
<code>toc</code>; however, with the
<dfn id=w3c-compat-class-toc><code>--w3c-compat-class-toc</code></dfn> option this is placed on every
<code>ol</code> within the table of contents. The entire <span>section
heading</span> is copied to be the content of the list item, with all
<code>a</code>, and <code>dfn</code> elements and <code>id</code> attributes
removed.</p>

<p>The table of contents is inserted between a comment with a value equal to
(with leading and trailing <a href=#whitespace>whitespace</a> removed)
<code>begin-toc</code> and one (under the same conditions) equal to
<code>end-toc</code>. If the comment with a value of <code>end-toc</code> does
that have the same parent as the previous <code>begin-toc</code> one, it is a
<a href=#fatal-error>fatal error</a>. Any nodes between the two are removed before the new
table of contents is inserted. Additionally, any comment (with leading and
trailing <a href=#whitespace>whitespace</a> removed) with a value equal to <code>toc</code>
is replaced by the table of contents surrounded by <code>begin-toc</code> and
<code>end-toc</code> comments.</p>
</body></html>