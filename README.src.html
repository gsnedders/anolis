<!doctype html>
<html lang="en-gb-x-sneddy">
<meta charset="utf-8">
<title>spec-gen 1.0a3-dev</title>
<link rel="stylesheet" href="http://www.whatwg.org/style/specification">
<style>
a:not([href]) {
background-color: #00f;
color: #fff;
}
span:not([title=""]):not(.secno) {
background-color: #a00;
color: #fff;
}
</style>

<div class="head">
	<h1>spec-gen 1.0a3-dev</h1>
	<h2 class="no-num no-toc">Documentation — [DATE]</h2>
</div>

<h2 class="no-num no-toc">Contents</h2>
<!--toc-->

<h2>Introduction</h2>

<p>The need for the spec-gen came from the need for long technical documents to
include niceties such as cross-references and a table of contents for the
purpose of easy navigation — doing this manually can be a great chore
especially when sections are numbered and a section is added, consequently
changing the numbering of many others, leading to it being advantageous to do it
programmatically.</p>

<h2>Installing the spec-gen</h2>

<h3>Requirements</h3>

<p>The following are the minimum requirements: later versions should also work
without issue.</p>

<ul>
	<li><a>Python</a> 2.5
	<li><a>lxml</a> 2.0
	<li><a>html5lib</a> 0.10
</ul>

<h3>Obtaining a copy</h3>

<p>Releases are occasionally made. A link to the latest release can be found
from the <a>spec-gen website</a>.</p>

<p>Alternatively, a copy can be obtained from <dfn>our <a>Mercurial</a>
repository</dfn>: this is where our ongoing development occurs, and allows any
revision (and therefore any release) to be downloaded. Our repository is located
at
<code><!--begin-link-->http://hg.gsnedders.com/spec-gen/<!--end-link--></code>.

<h3>Installation</h3>

<p>Normally, installation is done through <a>setuptools</a>, with the following
command:</p>

<p><code>python setup.py install</code></p>

<p>Please see setuptools' documentation for information on installation options
(such as installing in non-standard locations).</p>

<h3>Running the test suite</h3>

<p>The source distribution and the current development copy (in <span title="our
mercurial repository">Mercurial</span>) both contain a test suite. It can be run
with the following command:</p>

<p><code>python runtests.py</code></p>

<p>Any test failures should be reported at our <dfn><a
href="http://bugs.gsnedders.com/projects/show/spec-gen">bug
tracker</a></dfn>.</p>

<h2>Using the spec-gen</h2>

<p>The spec-gen is invoked through the <code>spec-gen</code> command. The most
basic options alter what is used to parse and serialize the document: by
default, html5lib is used to parse the document; passing the
<dfn><code>--lxml.html</code></dfn> option uses libxml2's HTML parser and
serializer instead (this is quicker, but does not comply to the HTML 5 standard,
and sometimes results in a fatal error)<!--; passing the
<dfn><code>--xml</code></dfn> option uses libxml2's XML parser instead-->.</p>

<h2>Processes</h2>

<p>The elements listed in the below processes, except where otherwise stated,
are the local name of the element <!--either--> in null namespace<!-- or in the
<dfn>HTML namespace</dfn> (<code>http://www.w3.org/1999/xhtml</code>)-->.</p>

<p>The <dfn>textContent</dfn> property is the same as that defined in <a>DOM
Level 3 Core</a> on the Node interface.</p>

<p><dfn>Whitespace</dfn> is as defined in <a>HTML 5</a>: <q>U+0020 SPACE, U+0009
CHARACTER TABULATION (tab), U+000A LINE FEED (LF), U+000C FORM FEED (FF), and
U+000D CARRIAGE RETURN (CR)</q>.</p>

<h3>Cross-referencing</h3>

<p><dfn>Cross-referencing</dfn> has two essential parts: <dfn
title="term">terms</dfn> that define what something is, and <dfn
title="instance">instances</dfn> of those terms.</p>

<p><span title="term">Terms</span> are marked-up using the <code>dfn</code>
element: the <span>term</span> itself is taken from the <code>title</code>
attribute if it is present, otherwise it is taken from the
<span>textContent</span> property of the <code>dfn</code> element. By default,
the spec-gen will throw a fatal error if a <span>term</span> is defined more
than once: this behaviour can be turned off (causing the final definition of the
<span>term</span> to be the one that is used) by the
<dfn><code>--allow-duplicate-terms</code></dfn> option.

<p><span title="instance">Instances</span> are marked-up with various elements,
depending on the setting of <dfn><code>--w3c-compat-elements</code></dfn>: if it
is disabled (the default), the <code>abbr</code>, <code>code</code>,
<code>i</code>, <code>span</code>, and <code>var</code> elements are used for
<span title="instance">instances</span>; if it is enabled, the
<code>abbr</code>, <code>acronym</code>, <code>b</code>, <code>bdo</code>,
<code>big</code>, <code>code</code>, <code>del</code>, <code>em</code>,
<code>i</code>, <code>ins</code>, <code>kbd</code>, <code>label</code>,
<code>legend</code>, <code>q</code>, <code>samp</code>, <code>small</code>,
<code>span</code>, <code>strong</code>, <code>sub</code>, <code>sup</code>,
<code>tt</code>, <code>var</code> elements are used for <span
title="instance">instances</span>. Those that are only there in
<span>compatibility mode</span> are there because either they shouldn't
semantically be used for an <span>instance</span>, or because they aren't
present in <a>HTML 5</a>. Similar to <span
title="term">terms</span>, the <span>instance</span> is taken from the
<code>title</code> attribute if it is present, otherwise it is taken from the
<span>textContent</span> property. An <span>instance</span> is only used if it
does not have an <code>a</code>, <code>dfn</code>, or <code>datagrid</code>
element as either a parent or a child.</p>

<p>Both <span title="term">terms</span> and <span
title="instance">instances</span> are <dfn title="cross-reference
normalization">normalized</dfn> as follows:</p>

<ul>
	<li>Leading and trailing <span>whitespace</span> is stripped,
	<li>Converted to lowercase (behaviour of this is dependent on the current
locale setting of Python),
	<li>All consecutive <span>whitespace</span> is replaced with a single U+0020
SPACE CHARACTER<!-- unless there is a <code>pre</code> element as a parent-->,
and
	<li>If <dfn><code>--w3c-compat-xref-normalization</code></dfn> is enabled, all
characters apart from U+0020 SPACE CHARACTER, U+002D HYPHEN-MINUS (-), U+0030
DIGIT ZERO to U+0039 DIGIT NINE (0–9), U+0041 LATIN CAPITAL LETTER A to U+005A
LATIN CAPITAL LETTER Z (A–Z), and U+0061 LATIN SMALL LETTER A to U+007A LATIN
SMALL LETTER Z (a–z) are removed.
</ul>

<p>If the <span>instance</span> is contained within a <code>span</code> element,
the <code>span</code> element is turned into an <code>a</code> element, and a
<code>href</code> attribute is added to link it to the <span>term</span> (e.g.,
<code>&lt;span>foo&lt;/span></code> becomes <code>&lt;a
href=#foo>foo&lt;/a></code>) — all other attributes are preserved. Otherwise
(when the <span>instance</span> is not contained within a <code>span</code>
element), the location of the <code>a</code> element when linking an
<span>instance</span> is dependent on the
<dfn><code>--w3c-compat-xref-a-placement</code></dfn> option: if it is disabled
(the default), the <code>a</code> element is placed around the element
containing the <span>instance</span> (e.g., <code>&lt;i>foo&lt;/i></code>
becomes <code>&lt;a href=#foo>&lt;i>foo&lt;/i>&lt;/a></code>); if it is enabled,
the <code>a</code> element goes within the element containing the
<span>instance</span> and goes around all of its content (e.g.,
<code>&lt;i>foo&lt;/i></code> becomes <code>&lt;i>&lt;a
href=#foo>foo&lt;/a>&lt;/i></code>).
